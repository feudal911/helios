{% extends "base.html" %}

{% block title %}Detalhes do Parque - HELIOS{% endblock %}

{% block content %}
<div class="row mb-4">
    <div class="col-md-8">
        <h1><i class="bi bi-building"></i> {{ parque.nome }}</h1>
    </div>
    <div class="col-md-4 text-end">
        <a href="{{ url_for('parques.editar', id=parque.id) }}" class="btn btn-warning">
            <i class="bi bi-pencil"></i> Editar
        </a>
        <a href="{{ url_for('parques.listar') }}" class="btn btn-secondary">
            <i class="bi bi-arrow-left"></i> Voltar
        </a>
    </div>
</div>

<div class="row">
    <div class="col-md-6">
        <div class="card">
            <div class="card-header">
                <h5>Informações do Parque</h5>
            </div>
            <div class="card-body">
                <p><strong>Nome:</strong> {{ parque.nome }}</p>
                <p><strong>Localização:</strong> {{ parque.localizacao }}</p>
                <p><strong>Capacidade Total:</strong> {{ "%.2f"|format(parque.capacidade_total_kw) }} kW</p>
                <p><strong>Data de Instalação:</strong> {{ parque.data_instalacao.strftime('%d/%m/%Y') }}</p>
                <p><strong>Status:</strong> 
                    {% if parque.status == 'ativo' %}
                        <span class="badge bg-success">{{ parque.status|title }}</span>
                    {% elif parque.status == 'inativo' %}
                        <span class="badge bg-secondary">{{ parque.status|title }}</span>
                    {% else %}
                        <span class="badge bg-warning">{{ parque.status|title }}</span>
                    {% endif %}
                </p>
                {% if parque.descricao %}
                <p><strong>Descrição:</strong> {{ parque.descricao }}</p>
                {% endif %}
            </div>
        </div>
    </div>
    <div class="col-md-6">
        <div class="card">
            <div class="card-header">
                <h5>Estatísticas</h5>
            </div>
            <div class="card-body">
                <p><strong>Total de Inversores:</strong> {{ total_inversores }}</p>
                <p><strong>Inversores Operacionais:</strong> {{ inversores_operacionais }}</p>
                <p><strong>Geração Hoje:</strong> {{ "%.2f"|format(geracao_hoje) }} kW</p>
            </div>
        </div>
    </div>
</div>

<div class="row mt-4">
    <div class="col-12">
        <div class="card">
            <div class="card-header">
                <h5>Inversores do Parque</h5>
            </div>
            <div class="card-body">
                {% if parque.inversores %}
                <div class="table-responsive">
                    <table class="table table-hover">
                        <thead>
                            <tr>
                                <th>Código de Série</th>
                                <th>Modelo</th>
                                <th>Capacidade (kW)</th>
                                <th>Status</th>
                                <th>Ações</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for inversor in parque.inversores %}
                            <tr>
                                <td>{{ inversor.codigo_serie }}</td>
                                <td>{{ inversor.modelo }}</td>
                                <td>{{ "%.2f"|format(inversor.capacidade_kw) }}</td>
                                <td>
                                    {% if inversor.status == 'operacional' %}
                                        <span class="badge bg-success">{{ inversor.status|title }}</span>
                                    {% elif inversor.status == 'manutencao' %}
                                        <span class="badge bg-warning">{{ inversor.status|title }}</span>
                                    {% else %}
                                        <span class="badge bg-secondary">{{ inversor.status|title }}</span>
                                    {% endif %}
                                </td>
                                <td>
                                    <a href="{{ url_for('inversores.detalhes', id=inversor.id) }}" 
                                       class="btn btn-sm btn-info">
                                        <i class="bi bi-eye"></i>
                                    </a>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
                {% else %}
                <p class="text-muted">Nenhum inversor cadastrado neste parque.</p>
                {% endif %}
            </div>
        </div>
    </div>
</div>
{% endblock %}

